
---

# 🚀 Extreme-Novel-Reader: 极速索引小说阅读器

本项目是一个基于 Python + Tkinter 的超大文本（TXT）阅读器方案。从最初的 800 行代码全量加载架构，进化到了如今仅 300 行的“字节索引 + 延迟渲染”极致架构。

核心功能

1. 文件处理
- 多格式支持：支持TXT文本文件读取
- 智能编码检测：自动识别UTF-8、GBK、GB2312等常见编码
- 手动编码选择：允许用户手动指定文件编码格式（应该根据选择的格式动态编码展示内容）
- 大文件优化：支持长篇小说的流畅加载

2. 章节管理
- 智能章节识别：通过正则表达式自动识别章节标题
- 动态目录生成：根据章节标题自动生成可交互的侧边栏目录
- 章节跳转：点击目录快速定位到指定章节
- 章节导航：支持左右方向键在章节间切换

3. 阅读体验优化
- 进度记忆：存储阅读位置，保证同一路径的文件再次打开可以记住上一次位置
- 滚动同步：实时显示阅读进度百分比（注意不要遮挡阅读内容）
- 视觉舒适：暖色调护眼配色方案，模拟纸质书阅读体验
- 键盘快捷：支持PageUp/PageDown翻页，E键编辑章节

4. 文本编辑功能
- 章节编辑：可以实时编辑当前章节内容
- 实时保存：修改后可以保存文件（最好可以修改原文件，也可以提示用户已修改，退出的时候或者可以主动下载修改过的文件）
- 变更追踪：提示用户有未保存的修改

5. 界面定制
- 主题切换：暖色和绿色两种护眼模式
- 响应式布局，字号和间距可以调整，但保持一个合适的默认设置。
- 侧边栏目录：滑动式目录面板不影响阅读区域
- 进度指示：底部进度条显示阅读完成度

主页面示例：
![主界面截图](assets/novel_reader_MainPage.png)

---

## 🏗 设计进化论：从“背诵全书”到“翻页阅读”

### 核心优化思路对比

| 维度 | GPT-5.3 Codex 设计 (v1.0) | Gemini 3.0 Flash 优化 (v3.5) | 性能提升原理 |
| :--- | :--- | :--- | :--- |
| **加载逻辑** | **全量解码 (Full Load)**。将 10MB 文本全部读入内存并转为 Unicode 字符串。 | **延迟加载 (Lazy Load)**。内存只存 Byte 流，UI 只解码当前显示的章节字节。 | **O(N) $\rightarrow$ O(1)**。渲染时间与文件大小解耦。 |
| **定位方式** | **行号定位**。通过计算文本行数来寻找位置。 | **物理字节索引 (Byte Offset)**。记录章节在文件中的绝对物理位置。 | **物理寻址**。`f.seek()` 瞬时定位，不随编码转换而偏移。 |
| **UI 响应** | 异步线程加载，但大文本上屏时主线程仍有明显掉帧或卡顿。 | **索引与渲染分离**。后台扫描器仅负责“数数”，前台只处理“当前一屏”。 | **计算负载均衡**。主线程几乎零负担，CPU 仅在翻页瞬间波动。 |
| **代码量** | 约 800+ 行。包含大量状态维护、复杂的行切片管理。 | 约 300+ 行。回归第一性原理，利用 OS 底层流处理特性。 | **架构降噪**。去除冗余逻辑，核心逻辑更清晰。 |

---

## 🤖 模型设计差异：GPT vs Gemini

在开发过程中，我们观察到了两款模型在处理复杂需求时的显著差异：

*   **GPT-5.3 Codex (传统强者)：**
    *   **思维方式**：倾向于“完善性”。它会写出非常详尽的代码，考虑各种边界条件（如自动备份、复杂的异常捕获），代码风格偏向成熟的商业软件架构。
    *   **结果**：功能极多，但往往导致代码库变得庞大（Boilerplate 代码多），在处理极致性能问题时可能因为“想得太多”而忽略了最简单的物理路径。

*   **Gemini 3.0 Flash (架构极简主义)：**
    *   **思维方式**：倾向于“本质论”。它会试图找出问题的物理瓶颈（如字符串解码和 DOM 渲染的开销），并用最直接的底层原理（字节流操作）去重构。
    *   **结果**：代码极度精简，通过“物理索引”这一关键点，实现了跨量级的性能飞跃。它展示了如何用 1/3 的代码量完成更优的性能表现。

---

## 🌐 衍生项目：Qwen-based HTML Reader

仓库中还包含一个由 **Qwen 3.0 Coder** 编写的 Web 版阅读器：
*   **技术栈**：HTML5 / Vanilla JS / File API。
*   **设计思路**：利用浏览器 `FileReader` 的 `slice` 功能实现相同逻辑的“分块加载”。
*   **适用场景**：无需安装 Python 环境，直接在浏览器中秒开 GB 级文本。

主页面示例：
![主界面截图](assets/HTML_NovelReader_Example.png)

支持打开txt小说，智能识别目录和提示目录。
背景支持暖色和护眼绿色。
使用浏览器的存储，支持定位上次阅读位置。    

**注意**：暂时不会再更新HTML阅读器，只是为了实验。Qwen3.0 Coder 首选了HTML实现PC端阅读器。

---

## 🛠 如何使用

### 1. 运行环境
```bash
pip install chardet
```

### 2. 启动阅读器
```bash
python novel_reader.py
```

### 3. 功能特性
*   **🎯 物理重定位**：即使索引未扫描完，也能通过 `byte_pos` 瞬间找回上次阅读进度。
*   **📏 动态样式**：支持行间距、字号调节，状态栏采用 `pack_propagate(False)` 确保在高分屏下永不消失。
*   **🎨 多主题切换**：内置纸质书（Warm）、护眼（Green）、极客（Dark）等多种配色。

---

## 📜 结语

这个项目不仅是一个工具，更是 AI 协助人类进行**架构重构**的典型案例。从 GPT 的“大而全”到 Gemini 的“精而强”，我们见证了逻辑简化的力量。

---

